plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
    id 'kotlin-parcelize'
    id 'kotlin-kapt'
    id 'com.google.devtools.ksp'
    id 'com.google.gms.google-services'
    id 'com.google.firebase.crashlytics'
    id 'android.aop'//æœ€å¥½æ”¾åœ¨æœ€åä¸€è¡Œ
}
apply from: '../common.gradle'
apply from: "utils.gradle"

// Android ä»£ç è§„èŒƒæ–‡æ¡£ï¼šhttps://github.com/getActivity/AndroidCodeStandard
android {
    namespace 'com.tt.dramatime'

    // èµ„æºç›®å½•å­˜æ”¾æŒ‡å¼•ï¼šhttps://developer.android.google.cn/guide/topics/resources/providing-resources
    defaultConfig {

        // æ— ç—›ä¿®æ”¹åŒ…åï¼šhttps://www.jianshu.com/p/17327e191d2e
        applicationId 'com.tt.dramatime'

        // ä»…ä¿ç•™ xxhdpi å›¾ç‰‡èµ„æºï¼ˆç›®å‰ä¸»æµåˆ†è¾¨ç‡ 1920 * 1080ï¼‰
        resourceConfigurations += ['xxhdpi']

        // æ··æ·†é…ç½®
        proguardFiles 'proguard-sdk.pro', 'proguard-app.pro'

        // æ—¥å¿—æ‰“å°å¼€å…³
        buildConfigField('boolean', 'LOG_ENABLE', '' + LOG_ENABLE + '')
        // æµ‹è¯•æœåŠ¡å™¨çš„ä¸»æœºåœ°å€
        buildConfigField('String', 'HOST_URL', '"' + HOST_URL + '"')
    }

    bundle {
        language {
            // This property is set to true by default.
            // You can specify `false` to turn off
            // generating configuration APKs for language resources.
            // These resources are instead packaged with each base and
            // feature APK.
            // Continue reading below to learn about situations when an app
            // might change setting to `false`, otherwise consider leaving
            // the default on for more optimized downloads.
            enableSplit = false
        }
    }

    // Apk ç­¾åçš„é‚£äº›äº‹ï¼šhttps://www.jianshu.com/p/a1f8e5896aa2
    signingConfigs {
        config {
            storeFile file(StoreFile)
            storePassword StorePassword
            keyAlias KeyAlias
            keyPassword KeyPassword
        }
    }
    packagingOptions {
        jniLibs {
            excludes += ['META-INF/*******', 'lib/armeabi/libijkhlscache-master.so', 'lib/armeabi-v7a/libijkhlscache-master.so', 'lib/arm64-v8a/libijkhlscache-master.so']
        }
        resources {
            excludes += ['META-INF/*******']
        }
        // æ–°å®¢æˆ·é›†æˆ SDK å»ºè®®æŠŠä¸‹é¢çš„è„šæœ¬åŠ ä¸Šï¼Œå¯ä»¥ä¼˜åŒ–åŒ…ä½“ç§¯
    }

    buildFeatures {
        viewBinding = true
        dataBinding = true
        buildConfig true //å¼€å¯è¿™ä¸ªå±æ€§åï¼ŒBuildConfig ç±»æ‰ä¼šè¢«ç¼–è¯‘åˆ° APK ä¸­ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥æ‹¿åˆ°DEBUGç­‰å‚æ•°çš„å€¼
    }

    // æ„å»ºé…ç½®ï¼šhttps://developer.android.google.cn/studio/build/build-variants
    buildTypes {

        debug {
            // ç»™åŒ…åæ·»åŠ åç¼€
            //applicationIdSuffix '.debug'
            // è°ƒè¯•æ¨¡å¼å¼€å…³
            debuggable true
            jniDebuggable true
            // å‹ç¼©å¯¹é½å¼€å…³
            zipAlignEnabled false
            // ç§»é™¤æ— ç”¨çš„èµ„æº
            shrinkResources false
            // ä»£ç æ··æ·†å¼€å…³
            minifyEnabled false
            // ç­¾åä¿¡æ¯é…ç½®
            signingConfig signingConfigs.config
            // æ·»åŠ æ¸…å•å ä½ç¬¦
            addManifestPlaceholders(['app_name'       : 'DramaTime Debug ç‰ˆ',
                                     'facebook_app_id': "1451335392425640"])
            // è°ƒè¯•æ¨¡å¼ä¸‹åªä¿ç•™ä¸€ç§æ¶æ„çš„ so åº“ï¼Œæå‡æ‰“åŒ…é€Ÿåº¦
            ndk {
                abiFilters 'armeabi-v7a', 'arm64-v8a'
            }
        }

        preview.initWith(debug)
        preview {
            applicationIdSuffix ''
            // æ·»åŠ æ¸…å•å ä½ç¬¦
            addManifestPlaceholders(['app_name'       : 'DramaTime Preview ç‰ˆ',
                                     'facebook_app_id': "1451335392425640"])
        }

        release {
            // è°ƒè¯•æ¨¡å¼å¼€å…³
            debuggable false
            jniDebuggable false
            // å‹ç¼©å¯¹é½å¼€å…³
            zipAlignEnabled true
            // ç§»é™¤æ— ç”¨çš„èµ„æº
            shrinkResources true
            // ä»£ç æ··æ·†å¼€å…³
            minifyEnabled true
            // ç­¾åä¿¡æ¯é…ç½®
            signingConfig signingConfigs.config
            // æ·»åŠ æ¸…å•å ä½ç¬¦
            addManifestPlaceholders(['app_name'       : '@string/app_name',
                                     'facebook_app_id': "1451335392425640"])
            // ä»…ä¿ç•™ä¸¤ç§æ¶æ„çš„ so åº“ï¼Œæ ¹æ® Bugly ç»Ÿè®¡å¾—å‡º
            ndk {
                // armeabiï¼šä¸‡é‡‘æ²¹æ¶æ„å¹³å°ï¼ˆå ç”¨ç‡ï¼š0%ï¼‰
                // armeabi-v7aï¼šæ›¾ç»ä¸»æµçš„æ¶æ„å¹³å°ï¼ˆå ç”¨ç‡ï¼š10%ï¼‰
                // arm64-v8aï¼šç›®å‰ä¸»æµæ¶æ„å¹³å°ï¼ˆå ç”¨ç‡ï¼š95%ï¼‰
                abiFilters 'armeabi-v7a', 'arm64-v8a'
            }
        }

    }

    // AOP é…ç½®ï¼ˆexclude å’Œ include äºŒé€‰ä¸€ï¼‰
    // éœ€è¦è¿›è¡Œé…ç½®ï¼Œå¦åˆ™å°±ä¼šå¼•å‘å†²çªï¼Œå…·ä½“è¡¨ç°ä¸ºï¼š
    // ç¬¬ä¸€ç§ï¼šç¼–è¯‘ä¸è¿‡å»ï¼ŒæŠ¥é”™ï¼šjava.util.zip.ZipExceptionï¼šCause: zip file is empty
    // ç¬¬äºŒç§ï¼šç¼–è¯‘èƒ½è¿‡å»ï¼Œä½†è¿è¡Œæ—¶æŠ¥é”™ï¼šClassNotFoundException: Didn't find class on path: DexPathList
    androidAopConfig {
        // enabled ä¸º false åˆ‡é¢ä¸å†èµ·ä½œç”¨ï¼Œé»˜è®¤ä¸å†™ä¸º true
        enabled true
        // åªå¯¹ä»¥ä¸‹åŒ…ååš AOP å¤„ç†
        include android.defaultConfig.applicationId
        // å¯æ’é™¤ kotlin ç›¸å…³ï¼Œæé«˜é€Ÿåº¦
        exclude 'kotlin.jvm', 'kotlin.internal', 'kotlinx.coroutines.internal', 'kotlinx.coroutines.android'
        // verifyLeafExtends æ˜¯å¦å¼€å¯éªŒè¯å¶å­ç»§æ‰¿ï¼Œé»˜è®¤æ‰“å¼€ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® @AndroidAopMatchClassMethod çš„ type = MatchType.LEAF_EXTENDSï¼Œå¯ä»¥å…³é—­
        verifyLeafExtends true
        //é»˜è®¤å…³é—­ï¼Œå¼€å¯åœ¨ Build æˆ– æ‰“åŒ…å å°†ä¼šç”Ÿæˆåˆ‡ç‚¹ä¿¡æ¯jsonæ–‡ä»¶åœ¨ app/build/tmp/cutInfo.json
        cutInfoJson false
        //é»˜è®¤å¼€å¯ï¼Œè®¾ç½® false åä¼šæ²¡æœ‰å¢é‡ç¼–è¯‘æ•ˆæœ ç­›é€‰ï¼ˆå…³é”®å­—ï¼š AndroidAOP woven info codeï¼‰ build è¾“å‡ºæ—¥å¿—å¯çœ‹æ—¶é—´
        increment = true//ä¿®æ”¹ã€å¢åŠ ã€åˆ é™¤åŒ¹é…åˆ‡é¢çš„è¯ï¼Œå°±ä¼šèµ°å…¨é‡ç¼–è¯‘
    }

    lint {
        disable 'HardcodedText', 'ContentDescription'
    }

    // app è¾“å‡ºæ–‡ä»¶åé…ç½®
    setProperty("archivesBaseName", getArtifactName(defaultConfig))
}

// æ·»åŠ æ„å»ºä¾èµ–é¡¹ï¼šhttps://developer.android.google.cn/studio/build/dependencies
// api ä¸ implementation çš„åŒºåˆ«ï¼šhttps://www.jianshu.com/p/8962d6ba936e
dependencies {
    // åŸºç±»å°è£…
    implementation project(':library:base')
    // æ§ä»¶å°è£…
    implementation project(':library:widget')

    // æƒé™è¯·æ±‚æ¡†æ¶ï¼šhttps://github.com/getActivity/XXPermissions
    implementation 'com.github.getActivity:XXPermissions:18.6'

    // æ ‡é¢˜æ æ¡†æ¶ï¼šhttps://github.com/getActivity/TitleBar
    implementation 'com.github.getActivity:TitleBar:10.5'

    // åå¸æ¡†æ¶ï¼šhttps://github.com/getActivity/Toaster
    implementation 'com.github.getActivity:Toaster:12.6'

    // ç½‘ç»œè¯·æ±‚æ¡†æ¶ï¼šhttps://github.com/getActivity/EasyHttp
    implementation 'com.github.getActivity:EasyHttp:12.8'
    // OkHttp æ¡†æ¶ï¼šhttps://github.com/square/okhttp
    implementation 'com.squareup.okhttp3:okhttp:4.11.0'

    // Json è§£ææ¡†æ¶ï¼šhttps://github.com/google/gson
    implementation 'com.google.code.gson:gson:2.10.1'
    // Gson è§£æå®¹é”™ï¼šhttps://github.com/getActivity/GsonFactory
    implementation 'com.github.getActivity:GsonFactory:9.5'
    // Kotlin åå°„åº“ï¼šç”¨äºåå°„ Kotlin data class ç±»å¯¹è±¡
    implementation 'org.jetbrains.kotlin:kotlin-reflect:1.9.22'

    // Shape æ¡†æ¶ï¼šhttps://github.com/getActivity/ShapeView
    implementation 'com.github.getActivity:ShapeView:9.0'

    // å›¾ç‰‡åŠ è½½æ¡†æ¶ï¼šhttps://github.com/bumptech/glide
    // å®˜æ–¹ä½¿ç”¨æ–‡æ¡£ï¼šhttps://github.com/Muyangmin/glide-docs-cn
    implementation 'com.github.bumptech.glide:glide:4.15.1'
    ksp 'com.github.bumptech.glide:ksp:4.15.1'

    // æ²‰æµ¸å¼æ¡†æ¶ï¼šhttps://github.com/gyf-dev/ImmersionBar
    implementation 'com.geyifeng.immersionbar:immersionbar:3.2.2'

    // æ‰‹åŠ¿ ImageViewï¼šhttps://github.com/Baseflow/PhotoView
    implementation 'com.github.Baseflow:PhotoView:2.3.0'

    // åŠ¨ç”»è§£æåº“ï¼šhttps://github.com/airbnb/lottie-android
    // åŠ¨ç”»èµ„æºï¼šhttps://lottiefiles.comã€https://icons8.com/animated-icons
    implementation 'com.airbnb.android:lottie:6.4.0'

    // ä¸Šæ‹‰åˆ·æ–°ä¸‹æ‹‰åŠ è½½æ¡†æ¶ï¼šhttps://github.com/scwang90/SmartRefreshLayout
    implementation 'io.github.scwang90:refresh-layout-kernel:2.1.0'
    implementation 'io.github.scwang90:refresh-header-material:2.1.0'
    implementation 'androidx.swiperefreshlayout:swiperefreshlayout:1.1.0'

    // æ—¥å¿—æ‰“å°æ¡†æ¶ï¼šhttps://github.com/JakeWharton/timber
    implementation 'com.jakewharton.timber:timber:5.0.1'

    // æŒ‡ç¤ºå™¨æ¡†æ¶ï¼šhttps://github.com/ongakuer/CircleIndicator
    implementation 'me.relex:circleindicator:2.1.6'

    // è…¾è®¯ MMKVï¼šhttps://github.com/Tencent/MMKV
    implementation 'com.tencent:mmkv:1.3.9'

    // å†…å­˜æ³„æ¼ç›‘æµ‹æ¡†æ¶ï¼šhttps://github.com/square/leakcanary
    debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.13'
    previewImplementation 'com.squareup.leakcanary:leakcanary-android:2.13'

    // è¯­ç§åˆ‡æ¢æ¡†æ¶ï¼šhttps://github.com/getActivity/MultiLanguages
    implementation 'com.github.getActivity:MultiLanguages:9.3'

    //AndroidAOP https://github.com/FlyJingFish/AndroidAOP å¿…é¡»é¡¹ ğŸ‘‡
    implementation 'io.github.FlyJingFish.AndroidAop:android-aop-core:2.0.6'
    implementation 'io.github.FlyJingFish.AndroidAop:android-aop-annotation:2.0.6'
    //éå¿…é¡»é¡¹ ğŸ‘‡ï¼Œå¦‚æœä½ æƒ³è‡ªå®šä¹‰åˆ‡é¢éœ€è¦ç”¨åˆ°ï¼Œâš ï¸æ”¯æŒJavaå’ŒKotlinä»£ç å†™çš„åˆ‡é¢
    ksp 'io.github.FlyJingFish.AndroidAop:android-aop-ksp:2.0.6'

    // RecyclerView Adapter: https://github.com/CymChad/BaseRecyclerViewAdapterHelper
    implementation 'androidx.recyclerview:recyclerview:1.3.2'
    implementation "io.github.cymchad:BaseRecyclerViewAdapterHelper4:4.1.4"

    //banner https://github.com/youth5201314/banner
    implementation 'io.github.youth5201314:banner:2.2.3'

    //DslTabLayout https://github.com/angcyo/DslTabLayout
    implementation 'com.github.angcyo.DslTablayout:TabLayout:3.5.5'
    implementation 'com.github.angcyo.DslTablayout:ViewPager1Delegate:3.5.5'
    implementation 'com.github.angcyo.DslTablayout:ViewPager2Delegate:3.5.5'

    //SmartViewPager2Adapter https://github.com/lihangleo2/ViewPager2Demo
    implementation 'com.github.lihangleo2:SmartViewPager2Adapter:3.0.0'

    // å·¥å…·ç±»ï¼šhttps://github.com/Blankj/AndroidUtilCode
    implementation 'com.blankj:utilcodex:1.31.1'

    //Logger æ‰“å°ï¼š https://github.com/orhanobut/logger
    implementation 'com.orhanobut:logger:2.2.0'

    //è…¾è®¯æ’­æ”¾å™¨ è·å–æœ€æ–°ç‰ˆæœ¬æŠŠç‰ˆæœ¬å·æ”¹æˆ latest.release https://cloud.tencent.com/document/product/881/67113#.E4.BA.8B.E4.BB.B6.E9.80.9A.E7.9F.A5.E6.8E.A5.E5.8F.A3
    implementation 'com.tencent.liteav:LiteAVSDK_Player_Premium:12.0.0.14689'

    //https://github.com/greenrobot/EventBus
    implementation 'org.greenrobot:eventbus:3.3.1'

    //å¯Œæ–‡æœ¬ https://github.com/iwgang/SimplifySpan
    implementation 'com.github.iwgang:simplifyspan:2.2'

    //https://github.com/DSAppTeam/PanelSwitchHelper/blob/master/README-zh.md
    implementation 'com.github.DSAppTeam:PanelSwitchHelper:v1.5.7'

    //Google Play æ”¯ä»˜ https://developer.android.com/google/play/billing/integrate?hl=zh-cn#java
    implementation "com.android.billingclient:billing-ktx:7.0.0"
    implementation 'com.google.guava:guava:32.0.1-jre'

    //https://firebase.google.com/docs/android/setup?authuser=1&hl=zh-cn
    implementation platform('com.google.firebase:firebase-bom:33.1.1')
    //firebaseç»Ÿè®¡
    implementation 'com.google.firebase:firebase-analytics-ktx'
    //firebaseæ¨é€
    implementation 'com.google.firebase:firebase-messaging-ktx'
    //firebaseå¼‚å¸¸æ•æ‰
    implementation 'com.google.firebase:firebase-crashlytics-ktx'
    //googleç™»å½•
    implementation 'com.google.android.gms:play-services-auth:21.2.0'
    //FaceBook sdk åŒ…å«FaceBookç™»å½• https://developers.facebook.com/docs/android/getting-started
    implementation 'com.facebook.android:facebook-android-sdk:17.0.0'

    //applovinèåˆå¹¿å‘Š https://dash.applovin.com/documentation/mediation/android/mediation-adapters?network=TIKTOK_NETWORK
    implementation 'com.applovin:applovin-sdk:12.5.0'
    implementation 'com.applovin.mediation:google-adapter:23.0.0.1'
    implementation 'com.applovin.mediation:ironsource-adapter:7.9.0.0.0'
    implementation 'com.applovin.mediation:facebook-adapter:6.17.0.0'
    implementation 'com.applovin.mediation:mintegral-adapter:16.6.71.0'
    implementation 'com.applovin.mediation:bytedance-adapter:5.8.1.0.1'
    implementation 'com.google.android.gms:play-services-ads-identifier:18.1.0'
    implementation 'com.google.android.ump:user-messaging-platform:2.2.0'

    //åº”ç”¨è§’æ ‡æ§åˆ¶ https://github.com/leolin310148/ShortcutBadger
    implementation 'me.leolin:ShortcutBadger:1.1.22@aar'

    //google installReferrer
    //https://developer.android.com/google/play/installreferrer?hl=zh-cn
    //https://developers.google.com/analytics/devguides/collection/android/v4/campaigns?hl=zh-cn
    implementation "com.android.installreferrer:installreferrer:2.2"

    //https://developers.google.com/admob/android/native?hl=zh-cn
    implementation 'com.google.android.gms:play-services-ads:23.2.0'

    //https://developer.android.com/guide/playcore?hl=zh-cn#playcore-migration
    implementation 'com.google.android.play:review-ktx:2.0.1'

    //https://github.com/z244370114/DeviceLibray
    implementation 'com.github.z244370114:DeviceLibray:1.0.5'

    //https://bytedance.sg.larkoffice.com/docx/VZ0Tdc94moOlevxkhZvlo2gFgle
    //https://business-api.tiktok.com/portal/docs?rid=rscv11ob9m9&id=1683138352999426
    implementation 'com.github.tiktok:tiktok-business-android-sdk:1.3.5'
    implementation 'androidx.lifecycle:lifecycle-process:2.6.2'
    implementation 'androidx.lifecycle:lifecycle-common-java8:2.6.2'

    //ç”¨äºåˆ›å»ºæ¨é€ä»»åŠ¡ https://developer.android.com/guide/background?hl=zh-cn#workmanager
    implementation "androidx.work:work-runtime-ktx:2.8.1"

    //å®˜æ–¹å»ºè®®ä½¿ç”¨SplashScreenåº“å®ç°å¯åŠ¨é¡µ https://developer.android.com/guide/topics/ui/splash-screen?hl=zh-cn
    implementation "androidx.core:core-splashscreen:1.0.1"

    //GooglePlayåº”ç”¨å†…æ›´æ–° https://developer.android.com/guide/playcore/in-app-updates/kotlin-java?hl=zh-cn
    implementation 'com.google.android.play:app-update-ktx:2.1.0'

    //https://github.com/getActivity/Logcat
    debugImplementation 'com.github.getActivity:Logcat:11.86'

    // å¤šè¯­ç§ï¼šhttps://github.com/getActivity/MultiLanguages
    // æ‚¬æµ®çª—ï¼šhttps://github.com/getActivity/XToast
    // æ—¥å¿—è¾“å‡ºï¼šhttps://github.com/getActivity/Logcat
    // è½®æ’­å›¾ï¼šhttps://github.com/bingoogolapple/BGABanner-Android
    // äºŒç»´ç ï¼šhttps://github.com/bingoogolapple/BGAQRCode-Android
    // è·‘é©¬ç¯ï¼šhttps://github.com/sunfusheng/MarqueeView
    // å¯¹è±¡æ³¨è§£ï¼šhttps://www.jianshu.com/p/f1f888e4a35f
    // å¯¹è±¡å­˜å‚¨ï¼šhttps://github.com/leavesC/DoKV
    // å¤šæ¸ é“æ‰“åŒ…ï¼šhttps://github.com/Meituan-Dianping/walle
    // è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼šhttp://msa-alliance.cn/col.jsp?id=120
    // åµŒå¥—æ»šåŠ¨å®¹å™¨ï¼šhttps://github.com/donkingliang/ConsecutiveScroller
    // éšç§è°ƒç”¨ç›‘æ§ï¼šhttps://github.com/huage2580/PermissionMonitor
}